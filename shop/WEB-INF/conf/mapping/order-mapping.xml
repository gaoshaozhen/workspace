<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 操作表 ：es_order -->  
<mapper namespace="orderMapper">
	<!-- 查询单个订单 -->
	<select id ="getOneOrderById"  parameterType="java.util.Map" resultType="java.util.Map">
        select * from es_order where order_id=#{order_id}        
    </select>
        
	<!-- 按照id查询订单 -->
    <select id ="getOrder"  parameterType="java.util.Map" resultType="java.util.Map">
        select * from es_order where order_id in 
    	  	<foreach item="item" index="index" collection="orderIds" open="(" separator="," close=")">  
				#{item}  
	  		</foreach>       	        
    </select>
        
    <!-- 查询所有订单 -->
    <select id="getOrderList" resultType="java.util.Map">
    	select * from es_order
    </select>
    
    <!-- 按照状态查询所有订单 -->
    <select id="getOrderListByStatus" resultType="java.util.Map">
    	select * from es_order where status = #{status}
    </select>
    
    <select id="getTimeoutOrder" parameterType="java.util.Map" resultType="java.util.Map">
   		select * from es_order where status= #{orderStatus} and create_time &lt; #{time}
    </select> 
    
    <!-- 插入订单信息 -->
     <insert id="addOrder" parameterType="java.util.Map" 
        useGeneratedKeys="true" keyProperty="order-id"> 
        insert into es_order(member_id,
        					 sn, 
        					 status, 
        					 pay_status, 
        					 payment_id, 
        					 paymoney,        					         					         				
        					 goods_num,
        					 gainedpoint,
        					 remark,
        					 create_time,
        					 ship_addr,
        					 ship_zip,
        					 ship_email,
        					 ship_mobile,
        					 ship_name)
        		values(#{memberId},
        			   #{sn},
        			   #{status},
        			   #{pay_status},
        			   #{payment_id},
        			   #{paymoney},        			           			   
        			   #{goods_num},
        			   #{gainedpoint},
        			   #{remark},
        			   #{createTime},
        			   #{shipAddr},
        			   #{shipZip},
        			   #{shipEmail},
        			   #{shipMobile},
        			   #{shipName})
    </insert>
    
    <!-- 删除订单 -->
    <delete id="deleteOrderById" parameterType="java.util.Map">
    	delete from es_order where id = #{id}     	
    </delete>
    
    <!--更新订单状态-->
    <update id="updateOrderById" parameterType="java.util.Map">
    	update es_order 
    	<set>
    		<if test="status != null">
    			status = #{status}
    		</if>
    		<if test="pay_status != null">
    			pay_status = #{pay_status}
    		</if>    		
    	</set>
    	where order_id = #{orderId}
    </update>
    <!--更新订单状态-->
    <update id="updateOrdersById" parameterType="java.util.Map">
    	update es_order 
    	<set>
    		<if test="status != null">
    			status = #{status}
    		</if>
    		<if test="pay_status != null">
    			pay_status = #{pay_status}
    		</if>    		
    	</set>
    	where order_id in
    	<!-- <foreach item="item" index="index" collection="orderIds" open="(" separator="," close=")"> 
    		#{item}
    	</foreach> -->
    	<foreach collection="orderIds"  item="item" separator="," open="(" close=")">
            #{item}
        </foreach>
    </update>
</mapper>