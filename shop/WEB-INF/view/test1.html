<!DOCTYPE html>
<html>
<body>

<p>要使用的图像：</p>
<img id="tulip" src="chat.jpg" alt="The Tulip" style="display: none;" />

<p>画布：</p>
<canvas id="myCanvas" width="500" height="300" style="border:1px solid #d3d3d3;">
</canvas>

<script>

var c=document.getElementById("myCanvas");
var ctx=c.getContext("2d");
var img=document.getElementById("tulip");
// ctx.drawImage(img,0,0);
   preImage("chat.jpg",function(){
       ctx.drawImage(this,0,0);
   });
   // preImage("wu.png",function(){
   //     ctx.drawImage(this,10,10);
   // });
   ctx.fillStyle = "#0f0";  
	ctx.font = "bold 20px Arial";  
	ctx.textBaseline = "top";  
	ctx.fillText("KingDZ原创", 50, 50); 
   ctx.strokeText("CodePlayer+中文测试", 50, 50);
   function preImage(url,callback){
       var img = new Image(); //创建一个Image对象，实现图片的预下载
       img.src = url;
       if (img.complete) { // 如果图片已经存在于浏览器缓存，直接调用回调函数
           callback.call(img);
           return; // 直接返回，不用再处理onload事件
       }
       img.onload = function () { //图片下载完毕时异步调用callback函数。
           callback.call(img);//将回调函数的this替换为Image对象
       };
   }
</script>
</body>
</html>
